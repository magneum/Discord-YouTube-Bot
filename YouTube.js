// ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
console.clear();
require('dotenv').config()
const Ê™á´á´›êœ°Éªx = process.env.BotFix;
const Êá´á´œá´›á´œÊ™á´‡á´›á´á´‹ = process.env.YouTubeFix;
const ÊœÊá´˜á´‡Êá´á´œá´›á´œÊ™á´‡server = require('./server');
const Discord = require("discord.js");
const ÊœÊá´˜á´‡Êá´á´œá´›á´œÊ™á´‡ = new Discord.Client();
const á´ á´Éªá´…á´…á´¡É´ = require("discord-ytdl-core");
const { createWriteStream } = require("fs");
const { Client } = require("youtubei");
const á´ á´Éªá´…Éªá´„ = new Client();
console.clear();
// ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
const Êá´á´œÊŸÉªêœ±á´›á´˜á´€á´›á´›á´‡Ê€É´ = /^.*(list=)([^#\&\?]*).*/gi;
const Êá´á´œÉ¢á´‡á´›á´˜á´€á´›á´›á´‡Ê€É´ = /^(https?:\/\/)?(www\.)?(m\.)?(youtube\.com|youtu\.?be)\/.+$/gi;
// ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
if (Ê™á´á´›êœ°Éªx === undefined) {
    console.log('ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\n\nPrefix is undefined')
    return;
}
if (Êá´á´œá´›á´œÊ™á´‡á´›á´á´‹ === undefined) {
    console.log('ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\n\nYouTubeTok is undefined')
    return;
}
// ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
ÊœÊá´˜á´‡Êá´á´œá´›á´œÊ™á´‡.on("ready",
    () => {
        console.clear();
        ÊœÊá´˜á´‡Êá´á´œá´›á´œÊ™á´‡.user.setActivity(`${Ê™á´á´›êœ°Éªx}yt â­•ï¸`,
            { type: 'WATCHING' });
        console.log(`
ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢
|
|â­•ï¸â€¢â€¢  Bot_Status : ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²-ğ— ğ˜‚ğ˜€ğ—¶ğ—° ğš’ğšœ ğ™¾ğš—ğš•ğš’ğš—ğš ! 
|â­•ï¸â€¢â€¢  Check Discord for: ğŸ”Š ${Ê™á´á´›êœ°Éªx}yt   
|
ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢`
        );
    });
// ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
ÊœÊá´˜á´‡Êá´á´œá´›á´œÊ™á´‡.on("message", async message => {
    // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
    if (message.author.bot)
        return;
    // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================   
    if (message.content.startsWith(Ê™á´á´›êœ°Éªx + "yt")) {
        let á´€Ê€É¢êœ± = message.content.split(' ').slice(1);
        // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
        if (!message.content.startsWith(Ê™á´á´›êœ°Éªx + "yt") && Êá´á´œÉ¢á´‡á´›á´˜á´€á´›á´›á´‡Ê€É´.test(á´€Ê€É¢êœ±[0])) {
            message.channel.send(`
${message.author}
**â€¢ âš ï¸WARNING:** Please use **${Ê™á´á´›êœ°Éªx}yt YouTube Url**`).catch(console.error);
            return;
        }
        // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
        if (Êá´á´œÊŸÉªêœ±á´›á´˜á´€á´›á´›á´‡Ê€É´.test(á´€Ê€É¢êœ±[0])) {
            message.channel.send(`
${message.author}
**â€¢ âš ï¸WARNING:** Please send **YouTube   _Single/Non-Playlist_   Urls Only**`).catch(console.error);
            return;
        }
        // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
        if (!á´€Ê€É¢êœ±[0])
            return message.channel.send(`
${message.author}
ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢

**â€¢ âš ï¸WARNING:** Please enter the **YouTube URL** of a song !
**â€¢ EX:** ${Ê™á´á´›êœ°Éªx}yt https://www.youtube\.com|youtu`).catch(console.error);
        // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
        let Êá´á´œá´›á´€á´‹á´‡Ê€;
        let Êá´á´œêœ±á´›Ê€á´‡á´€á´á´‡Ê€;
        // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
        try {
            Êá´á´œêœ±á´›Ê€á´‡á´€á´á´‡Ê€ = á´ á´Éªá´…á´…á´¡É´(á´€Ê€É¢êœ±.join(" "), {
                encoderArgs: ['-af', 'dynaudnorm=f=200'], fmt: 'mp3', opusEncoded: false
            });
            Êá´á´œá´›á´€á´‹á´‡Ê€ = await á´ á´Éªá´…Éªá´„.search(á´€Ê€É¢êœ±.join(" "));
        } catch (e) {
            return message.channel.send(`
${message.author}
ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢

**â€¢ âš ï¸WARNING:** I didn't find anything for: **${á´€Ê€É¢êœ±.join(" ")}**`).catch(console.error);
        }
        // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
        try {
            message.channel.send(`
${message.author}
ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢

â€¢:shaved_ice:**SongTitle:** _${Êá´á´œá´›á´€á´‹á´‡Ê€[0].title}_
â€¢:chains:**SongUrl:**   _${á´€Ê€É¢êœ±}_

Please Wait till ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° finishes downloading...`).catch(console.error);
            Êá´á´œêœ±á´›Ê€á´‡á´€á´á´‡Ê€.pipe(createWriteStream(__dirname + `/YTubeTemp/${Êá´á´œá´›á´€á´‹á´‡Ê€[0].title}.mp3`)).on('finish', () => {
                try {
                    // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
                    try {
                        message.delete()
                    } catch (e) {
                        console.log(e)
                    }
                    // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
                    message.channel.send(`ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢
â€¢:shaved_ice:**SongTitle:** _${Êá´á´œá´›á´€á´‹á´‡Ê€[0].title}_
â€¢:chains:**SongUrl:**   _${á´€Ê€É¢êœ±}_`,
                        new Discord.MessageAttachment(__dirname + `/YTubeTemp/${Êá´á´œá´›á´€á´‹á´‡Ê€[0].title}.mp3`, `${Êá´á´œá´›á´€á´‹á´‡Ê€[0].title}.mp3`)
                    )
                } catch (e) {
                    return message.channel.send(`
${message.author}
ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢

**â€¢ ğŸ”¥ERROR:** 
I didn't manage to send the music... 

Maybe it's too heavy for Discord ? 
Or 
Maybe I don't have the required permissions to upload this type of file on this server...`).catch(console.error);
                }
            })
            // ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
        } catch (e) {
            return message.channel.send(`
${message.author}
ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—° |>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢

**â€¢ ğŸ”¥ERROR:**
I didn't find anything for : **${á´€Ê€É¢êœ±.join(" ")}**

Maybe it is impossible to retrieve this music...`).catch(console.error);
        }
    }
});
// ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================
ÊœÊá´˜á´‡Êá´á´œá´›á´œÊ™á´‡server()
ÊœÊá´˜á´‡Êá´á´œá´›á´œÊ™á´‡.login(Êá´á´œá´›á´œÊ™á´‡á´›á´á´‹).catch(console.error);
// ===========================================ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²â­•ï¸ğ— ğ˜‚ğ˜€ğ—¶ğ—°==================================================